window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;

var playmap = new function() {
	this.map = document.getElementById("playmap");
	this.leftBound = 4;
	this.topBound = 2;
	this.rightBound = this.map.clientWidth - this.leftBound;
	this.bottomBound = this.map.clientHeight - this.topBound;
	this.warpTop = 262;
	this.warpBottom = 302;
	this.vertWallCoords = [
		// xWall, xTop, xBottom
		[this.leftBound, this.topBound, this.warpTop], // 4, 2, 262
		[this.leftBound, this.warpBottom, this.bottomBound], // 4, 302, 602
		[44, 42, 82], [104, 42, 82], // box1
		[144, 42, 82], [229, 42, 82], // box2
		[269, 2, 82], [289, 2, 82], // box3
		[329, 42, 82], [414, 42, 82], // box4
		[454, 42, 82], [514, 42, 82], // box5
		[44, 122, 142], [104, 122, 142], // box6
		[144, 122, 261], [164, 122, 261], // box7
		[164, 182, 202], [229, 182, 202], // box8
		[204, 122, 142], [352, 122, 142], // box9
		[269, 142, 202], [289, 142, 202], // box10
		[329, 182, 202], [394, 182, 202], // box11
		[394, 122, 261], [414, 122, 261], // box12
		[454, 122, 142], [514, 122, 142], // box13
		[0, 182, 262], [104, 182, 262], // box14
		[454, 182, 262], [558, 182, 262], // box15
		[204, 242, 321], [354, 242, 321], // box16
		[0, 302, 382], [104, 302, 382], // box17
		[144, 302, 382], [164, 302, 382], // box18
		[204, 362, 382], [354, 362, 382], // box19
		[394, 302, 382], [414, 302, 382], // box20
		[454, 302, 382], [558, 302, 382], // box21
		[44, 422, 442], [104, 422, 442], // box22
		[144, 422, 442], [229, 422, 442], // box23
		[269, 382, 442], [289, 382, 442], // box24
		[329, 422, 442], [414, 422, 442], // box25
		[454, 422, 442], [514, 422, 442], // box26
		[0, 482, 502], [44, 482, 502], // box27
		[84, 442, 502], [104, 442, 502], // box28
		[144, 482, 542], [164, 482, 542], // box29
		[204, 482, 502], [352, 482, 502], // box30
		[394, 482, 542], [414, 482, 542], // box31
		[454, 442, 502], [474, 442, 502], // box32
		[514, 482, 502], [548, 482, 502], // box33
		[44, 542, 562], [229, 542, 562], // box34
		[269, 502, 562], [289, 502, 562], // box35
		[329, 542, 562], [514, 542, 562], // box36
		[this.rightBound, this.topBound, this.warpTop], // 554, 2, 602
		[this.rightBound, this.warpBottom, this.bottomBound], // 4, 302, 602
	];
	this.horzWallCoords = [
		// yWall, yLeft, yRight
		[this.topBound, this.leftBound, this.rightBound], // 2, 4, 554
		[42, 44, 104], [82, 44, 104], // box1
		[42, 144, 229], [82, 144, 229], // box2
		[2, 269, 289], [82, 269, 289], // box3
		[42, 329, 414], [82, 329, 414], // box4
		[42, 454, 514], [82, 454, 514], // box5
		[122, 44, 104], [142, 44, 104], // box6
		[122, 144, 164], [261, 144, 164], // box7
		[182, 164, 229], [202, 164, 229], // box8
		[122, 204, 352], [142, 204, 352], // box9
		[142, 269, 289], [202, 269, 289], // box10
		[182, 329, 394], [202, 329, 394], // box11
		[122, 394, 414], [261, 394, 414], // box12
		[122, 454, 514], [142, 454, 514], // box13
		[182, 0, 104], [262, 0, 104], // box14
		[182, 454, 558], [262, 454, 558], // box15
		[242, 204, 354], [321, 204, 354], // box16
		[302, 0, 104], [382, 0, 104], // box17
		[302, 144, 164], [382, 144, 164], // box18
		[362, 204, 354], [382, 204, 354], // box19
		[302, 394, 414], [382, 394, 414], // box20
		[302, 454, 558], [382, 454, 558], // box21
		[422, 44, 104], [442, 44, 104], // box22
		[422, 144, 229], [442, 144, 229], // box23
		[382, 269, 289], [442, 269, 289], // box24
		[422, 329, 414], [442, 329, 414], // box25
		[422, 454, 514], [442, 454, 514], // box26
		[482, 0, 44], [502, 0, 44], // box27
		[442, 84, 104], [502, 84, 104], // box28
		[482, 144, 164], [542, 144, 164], // box29
		[482, 204, 352], [502, 204, 352], // box30
		[482, 394, 414], [542, 394, 414], // box31
		[442, 454, 474], [502, 454, 474], // box32
		[482, 514, 548], [502, 514, 548], // box33
		[542, 44, 229], [562, 44, 229], // box34
		[502, 269, 289], [562, 269, 289], // box35
		[542, 329, 514], [562, 329, 514], // box36
		[this.bottomBound, this.leftBound, this.rightBound] // 602, 4, 554
	];
}

var foodCoords = [
[20,19,"x1y1"],[40,19,"x2y1"],[61,19,"x3y1"],[82,19,"x4y1"],[102,19,"x5y1"],[123,19,"x6y1"],[144,19,"x7y1"],[164,19,"x8y1"],[185,19,"x9y1"],[206,19,"x10y1"],[226,19,"x11y1"],[247,19,"x12y1"],[267,19,"x13y1"],[288,19,"x14y1"],[309,19,"x15y1"],[329,19,"x16y1"],[350,19,"x17y1"],[371,19,"x18y1"],[391,19,"x19y1"],[412,19,"x20y1"],[433,19,"x21y1"],[453,19,"x22y1"],[474,19,"x23y1"],[495,19,"x24y1"],[515,19,"x25y1"],[536,19,"x26y1"],
[20,39,"x1y2"],[40,39,"x2y2"],[61,39,"x3y2"],[82,39,"x4y2"],[102,39,"x5y2"],[123,39,"x6y2"],[144,39,"x7y2"],[164,39,"x8y2"],[185,39,"x9y2"],[206,39,"x10y2"],[226,39,"x11y2"],[247,39,"x12y2"],[267,39,"x13y2"],[288,39,"x14y2"],[309,39,"x15y2"],[329,39,"x16y2"],[350,39,"x17y2"],[371,39,"x18y2"],[391,39,"x19y2"],[412,39,"x20y2"],[433,39,"x21y2"],[453,39,"x22y2"],[474,39,"x23y2"],[495,39,"x24y2"],[515,39,"x25y2"],[536,39,"x26y2"],
[20,59,"x1y3"],[40,59,"x2y3"],[61,59,"x3y3"],[82,59,"x4y3"],[102,59,"x5y3"],[123,59,"x6y3"],[144,59,"x7y3"],[164,59,"x8y3"],[185,59,"x9y3"],[206,59,"x10y3"],[226,59,"x11y3"],[247,59,"x12y3"],[267,59,"x13y3"],[288,59,"x14y3"],[309,59,"x15y3"],[329,59,"x16y3"],[350,59,"x17y3"],[371,59,"x18y3"],[391,59,"x19y3"],[412,59,"x20y3"],[433,59,"x21y3"],[453,59,"x22y3"],[474,59,"x23y3"],[495,59,"x24y3"],[515,59,"x25y3"],[536,59,"x26y3"],
[20,79,"x1y4"],[40,79,"x2y4"],[61,79,"x3y4"],[82,79,"x4y4"],[102,79,"x5y4"],[123,79,"x6y4"],[144,79,"x7y4"],[164,79,"x8y4"],[185,79,"x9y4"],[206,79,"x10y4"],[226,79,"x11y4"],[247,79,"x12y4"],[267,79,"x13y4"],[288,79,"x14y4"],[309,79,"x15y4"],[329,79,"x16y4"],[350,79,"x17y4"],[371,79,"x18y4"],[391,79,"x19y4"],[412,79,"x20y4"],[433,79,"x21y4"],[453,79,"x22y4"],[474,79,"x23y4"],[495,79,"x24y4"],[515,79,"x25y4"],[536,79,"x26y4"],
[20,99,"x1y5"],[40,99,"x2y5"],[61,99,"x3y5"],[82,99,"x4y5"],[102,99,"x5y5"],[123,99,"x6y5"],[144,99,"x7y5"],[164,99,"x8y5"],[185,99,"x9y5"],[206,99,"x10y5"],[226,99,"x11y5"],[247,99,"x12y5"],[267,99,"x13y5"],[288,99,"x14y5"],[309,99,"x15y5"],[329,99,"x16y5"],[350,99,"x17y5"],[371,99,"x18y5"],[391,99,"x19y5"],[412,99,"x20y5"],[433,99,"x21y5"],[453,99,"x22y5"],[474,99,"x23y5"],[495,99,"x24y5"],[515,99,"x25y5"],[536,99,"x26y5"],
[20,119,"x1y6"],[40,119,"x2y6"],[61,119,"x3y6"],[82,119,"x4y6"],[102,119,"x5y6"],[123,119,"x6y6"],[144,119,"x7y6"],[164,119,"x8y6"],[185,119,"x9y6"],[206,119,"x10y6"],[226,119,"x11y6"],[247,119,"x12y6"],[267,119,"x13y6"],[288,119,"x14y6"],[309,119,"x15y6"],[329,119,"x16y6"],[350,119,"x17y6"],[371,119,"x18y6"],[391,119,"x19y6"],[412,119,"x20y6"],[433,119,"x21y6"],[453,119,"x22y6"],[474,119,"x23y6"],[495,119,"x24y6"],[515,119,"x25y6"],[536,119,"x26y6"],
[20,139,"x1y7"],[40,139,"x2y7"],[61,139,"x3y7"],[82,139,"x4y7"],[102,139,"x5y7"],[123,139,"x6y7"],[144,139,"x7y7"],[164,139,"x8y7"],[185,139,"x9y7"],[206,139,"x10y7"],[226,139,"x11y7"],[247,139,"x12y7"],[267,139,"x13y7"],[288,139,"x14y7"],[309,139,"x15y7"],[329,139,"x16y7"],[350,139,"x17y7"],[371,139,"x18y7"],[391,139,"x19y7"],[412,139,"x20y7"],[433,139,"x21y7"],[453,139,"x22y7"],[474,139,"x23y7"],[495,139,"x24y7"],[515,139,"x25y7"],[536,139,"x26y7"],
[20,159,"x1y8"],[40,159,"x2y8"],[61,159,"x3y8"],[82,159,"x4y8"],[102,159,"x5y8"],[123,159,"x6y8"],[144,159,"x7y8"],[164,159,"x8y8"],[185,159,"x9y8"],[206,159,"x10y8"],[226,159,"x11y8"],[247,159,"x12y8"],[267,159,"x13y8"],[288,159,"x14y8"],[309,159,"x15y8"],[329,159,"x16y8"],[350,159,"x17y8"],[371,159,"x18y8"],[391,159,"x19y8"],[412,159,"x20y8"],[433,159,"x21y8"],[453,159,"x22y8"],[474,159,"x23y8"],[495,159,"x24y8"],[515,159,"x25y8"],[536,159,"x26y8"],
[20,179,"x1y9"],[40,179,"x2y9"],[61,179,"x3y9"],[82,179,"x4y9"],[102,179,"x5y9"],[123,179,"x6y9"],[144,179,"x7y9"],[164,179,"x8y9"],[185,179,"x9y9"],[206,179,"x10y9"],[226,179,"x11y9"],[247,179,"x12y9"],[267,179,"x13y9"],[288,179,"x14y9"],[309,179,"x15y9"],[329,179,"x16y9"],[350,179,"x17y9"],[371,179,"x18y9"],[391,179,"x19y9"],[412,179,"x20y9"],[433,179,"x21y9"],[453,179,"x22y9"],[474,179,"x23y9"],[495,179,"x24y9"],[515,179,"x25y9"],[536,179,"x26y9"],
[20,199,"x1y10"],[40,199,"x2y10"],[61,199,"x3y10"],[82,199,"x4y10"],[102,199,"x5y10"],[123,199,"x6y10"],[144,199,"x7y10"],[164,199,"x8y10"],[185,199,"x9y10"],[206,199,"x10y10"],[226,199,"x11y10"],[247,199,"x12y10"],[267,199,"x13y10"],[288,199,"x14y10"],[309,199,"x15y10"],[329,199,"x16y10"],[350,199,"x17y10"],[371,199,"x18y10"],[391,199,"x19y10"],[412,199,"x20y10"],[433,199,"x21y10"],[453,199,"x22y10"],[474,199,"x23y10"],[495,199,"x24y10"],[515,199,"x25y10"],[536,199,"x26y10"],
[20,219,"x1y11"],[40,219,"x2y11"],[61,219,"x3y11"],[82,219,"x4y11"],[102,219,"x5y11"],[123,219,"x6y11"],[144,219,"x7y11"],[164,219,"x8y11"],[185,219,"x9y11"],[206,219,"x10y11"],[226,219,"x11y11"],[247,219,"x12y11"],[267,219,"x13y11"],[288,219,"x14y11"],[309,219,"x15y11"],[329,219,"x16y11"],[350,219,"x17y11"],[371,219,"x18y11"],[391,219,"x19y11"],[412,219,"x20y11"],[433,219,"x21y11"],[453,219,"x22y11"],[474,219,"x23y11"],[495,219,"x24y11"],[515,219,"x25y11"],[536,219,"x26y11"],
[20,239,"x1y12"],[40,239,"x2y12"],[61,239,"x3y12"],[82,239,"x4y12"],[102,239,"x5y12"],[123,239,"x6y12"],[144,239,"x7y12"],[164,239,"x8y12"],[185,239,"x9y12"],[206,239,"x10y12"],[226,239,"x11y12"],[247,239,"x12y12"],[267,239,"x13y12"],[288,239,"x14y12"],[309,239,"x15y12"],[329,239,"x16y12"],[350,239,"x17y12"],[371,239,"x18y12"],[391,239,"x19y12"],[412,239,"x20y12"],[433,239,"x21y12"],[453,239,"x22y12"],[474,239,"x23y12"],[495,239,"x24y12"],[515,239,"x25y12"],[536,239,"x26y12"],
[20,259,"x1y13"],[40,259,"x2y13"],[61,259,"x3y13"],[82,259,"x4y13"],[102,259,"x5y13"],[123,259,"x6y13"],[144,259,"x7y13"],[164,259,"x8y13"],[185,259,"x9y13"],[206,259,"x10y13"],[226,259,"x11y13"],[247,259,"x12y13"],[267,259,"x13y13"],[288,259,"x14y13"],[309,259,"x15y13"],[329,259,"x16y13"],[350,259,"x17y13"],[371,259,"x18y13"],[391,259,"x19y13"],[412,259,"x20y13"],[433,259,"x21y13"],[453,259,"x22y13"],[474,259,"x23y13"],[495,259,"x24y13"],[515,259,"x25y13"],[536,259,"x26y13"],
[20,279,"x1y14"],[40,279,"x2y14"],[61,279,"x3y14"],[82,279,"x4y14"],[102,279,"x5y14"],[123,279,"x6y14"],[144,279,"x7y14"],[164,279,"x8y14"],[185,279,"x9y14"],[206,279,"x10y14"],[226,279,"x11y14"],[247,279,"x12y14"],[267,279,"x13y14"],[288,279,"x14y14"],[309,279,"x15y14"],[329,279,"x16y14"],[350,279,"x17y14"],[371,279,"x18y14"],[391,279,"x19y14"],[412,279,"x20y14"],[433,279,"x21y14"],[453,279,"x22y14"],[474,279,"x23y14"],[495,279,"x24y14"],[515,279,"x25y14"],[536,279,"x26y14"],
[20,299,"x1y15"],[40,299,"x2y15"],[61,299,"x3y15"],[82,299,"x4y15"],[102,299,"x5y15"],[123,299,"x6y15"],[144,299,"x7y15"],[164,299,"x8y15"],[185,299,"x9y15"],[206,299,"x10y15"],[226,299,"x11y15"],[247,299,"x12y15"],[267,299,"x13y15"],[288,299,"x14y15"],[309,299,"x15y15"],[329,299,"x16y15"],[350,299,"x17y15"],[371,299,"x18y15"],[391,299,"x19y15"],[412,299,"x20y15"],[433,299,"x21y15"],[453,299,"x22y15"],[474,299,"x23y15"],[495,299,"x24y15"],[515,299,"x25y15"],[536,299,"x26y15"],
[20,319,"x1y16"],[40,319,"x2y16"],[61,319,"x3y16"],[82,319,"x4y16"],[102,319,"x5y16"],[123,319,"x6y16"],[144,319,"x7y16"],[164,319,"x8y16"],[185,319,"x9y16"],[206,319,"x10y16"],[226,319,"x11y16"],[247,319,"x12y16"],[267,319,"x13y16"],[288,319,"x14y16"],[309,319,"x15y16"],[329,319,"x16y16"],[350,319,"x17y16"],[371,319,"x18y16"],[391,319,"x19y16"],[412,319,"x20y16"],[433,319,"x21y16"],[453,319,"x22y16"],[474,319,"x23y16"],[495,319,"x24y16"],[515,319,"x25y16"],[536,319,"x26y16"],
[20,339,"x1y17"],[40,339,"x2y17"],[61,339,"x3y17"],[82,339,"x4y17"],[102,339,"x5y17"],[123,339,"x6y17"],[144,339,"x7y17"],[164,339,"x8y17"],[185,339,"x9y17"],[206,339,"x10y17"],[226,339,"x11y17"],[247,339,"x12y17"],[267,339,"x13y17"],[288,339,"x14y17"],[309,339,"x15y17"],[329,339,"x16y17"],[350,339,"x17y17"],[371,339,"x18y17"],[391,339,"x19y17"],[412,339,"x20y17"],[433,339,"x21y17"],[453,339,"x22y17"],[474,339,"x23y17"],[495,339,"x24y17"],[515,339,"x25y17"],[536,339,"x26y17"],
[20,359,"x1y18"],[40,359,"x2y18"],[61,359,"x3y18"],[82,359,"x4y18"],[102,359,"x5y18"],[123,359,"x6y18"],[144,359,"x7y18"],[164,359,"x8y18"],[185,359,"x9y18"],[206,359,"x10y18"],[226,359,"x11y18"],[247,359,"x12y18"],[267,359,"x13y18"],[288,359,"x14y18"],[309,359,"x15y18"],[329,359,"x16y18"],[350,359,"x17y18"],[371,359,"x18y18"],[391,359,"x19y18"],[412,359,"x20y18"],[433,359,"x21y18"],[453,359,"x22y18"],[474,359,"x23y18"],[495,359,"x24y18"],[515,359,"x25y18"],[536,359,"x26y18"],
[20,379,"x1y19"],[40,379,"x2y19"],[61,379,"x3y19"],[82,379,"x4y19"],[102,379,"x5y19"],[123,379,"x6y19"],[144,379,"x7y19"],[164,379,"x8y19"],[185,379,"x9y19"],[206,379,"x10y19"],[226,379,"x11y19"],[247,379,"x12y19"],[267,379,"x13y19"],[288,379,"x14y19"],[309,379,"x15y19"],[329,379,"x16y19"],[350,379,"x17y19"],[371,379,"x18y19"],[391,379,"x19y19"],[412,379,"x20y19"],[433,379,"x21y19"],[453,379,"x22y19"],[474,379,"x23y19"],[495,379,"x24y19"],[515,379,"x25y19"],[536,379,"x26y19"],
[20,399,"x1y20"],[40,399,"x2y20"],[61,399,"x3y20"],[82,399,"x4y20"],[102,399,"x5y20"],[123,399,"x6y20"],[144,399,"x7y20"],[164,399,"x8y20"],[185,399,"x9y20"],[206,399,"x10y20"],[226,399,"x11y20"],[247,399,"x12y20"],[267,399,"x13y20"],[288,399,"x14y20"],[309,399,"x15y20"],[329,399,"x16y20"],[350,399,"x17y20"],[371,399,"x18y20"],[391,399,"x19y20"],[412,399,"x20y20"],[433,399,"x21y20"],[453,399,"x22y20"],[474,399,"x23y20"],[495,399,"x24y20"],[515,399,"x25y20"],[536,399,"x26y20"],
[20,419,"x1y21"],[40,419,"x2y21"],[61,419,"x3y21"],[82,419,"x4y21"],[102,419,"x5y21"],[123,419,"x6y21"],[144,419,"x7y21"],[164,419,"x8y21"],[185,419,"x9y21"],[206,419,"x10y21"],[226,419,"x11y21"],[247,419,"x12y21"],[267,419,"x13y21"],[288,419,"x14y21"],[309,419,"x15y21"],[329,419,"x16y21"],[350,419,"x17y21"],[371,419,"x18y21"],[391,419,"x19y21"],[412,419,"x20y21"],[433,419,"x21y21"],[453,419,"x22y21"],[474,419,"x23y21"],[495,419,"x24y21"],[515,419,"x25y21"],[536,419,"x26y21"],
[20,439,"x1y22"],[40,439,"x2y22"],[61,439,"x3y22"],[82,439,"x4y22"],[102,439,"x5y22"],[123,439,"x6y22"],[144,439,"x7y22"],[164,439,"x8y22"],[185,439,"x9y22"],[206,439,"x10y22"],[226,439,"x11y22"],[247,439,"x12y22"],[267,439,"x13y22"],[288,439,"x14y22"],[309,439,"x15y22"],[329,439,"x16y22"],[350,439,"x17y22"],[371,439,"x18y22"],[391,439,"x19y22"],[412,439,"x20y22"],[433,439,"x21y22"],[453,439,"x22y22"],[474,439,"x23y22"],[495,439,"x24y22"],[515,439,"x25y22"],[536,439,"x26y22"],
[20,459,"x1y23"],[40,459,"x2y23"],[61,459,"x3y23"],[82,459,"x4y23"],[102,459,"x5y23"],[123,459,"x6y23"],[144,459,"x7y23"],[164,459,"x8y23"],[185,459,"x9y23"],[206,459,"x10y23"],[226,459,"x11y23"],[247,459,"x12y23"],[267,459,"x13y23"],[288,459,"x14y23"],[309,459,"x15y23"],[329,459,"x16y23"],[350,459,"x17y23"],[371,459,"x18y23"],[391,459,"x19y23"],[412,459,"x20y23"],[433,459,"x21y23"],[453,459,"x22y23"],[474,459,"x23y23"],[495,459,"x24y23"],[515,459,"x25y23"],[536,459,"x26y23"],
[20,479,"x1y24"],[40,479,"x2y24"],[61,479,"x3y24"],[82,479,"x4y24"],[102,479,"x5y24"],[123,479,"x6y24"],[144,479,"x7y24"],[164,479,"x8y24"],[185,479,"x9y24"],[206,479,"x10y24"],[226,479,"x11y24"],[247,479,"x12y24"],[267,479,"x13y24"],[288,479,"x14y24"],[309,479,"x15y24"],[329,479,"x16y24"],[350,479,"x17y24"],[371,479,"x18y24"],[391,479,"x19y24"],[412,479,"x20y24"],[433,479,"x21y24"],[453,479,"x22y24"],[474,479,"x23y24"],[495,479,"x24y24"],[515,479,"x25y24"],[536,479,"x26y24"],
[20,499,"x1y25"],[40,499,"x2y25"],[61,499,"x3y25"],[82,499,"x4y25"],[102,499,"x5y25"],[123,499,"x6y25"],[144,499,"x7y25"],[164,499,"x8y25"],[185,499,"x9y25"],[206,499,"x10y25"],[226,499,"x11y25"],[247,499,"x12y25"],[267,499,"x13y25"],[288,499,"x14y25"],[309,499,"x15y25"],[329,499,"x16y25"],[350,499,"x17y25"],[371,499,"x18y25"],[391,499,"x19y25"],[412,499,"x20y25"],[433,499,"x21y25"],[453,499,"x22y25"],[474,499,"x23y25"],[495,499,"x24y25"],[515,499,"x25y25"],[536,499,"x26y25"],
[20,519,"x1y26"],[40,519,"x2y26"],[61,519,"x3y26"],[82,519,"x4y26"],[102,519,"x5y26"],[123,519,"x6y26"],[144,519,"x7y26"],[164,519,"x8y26"],[185,519,"x9y26"],[206,519,"x10y26"],[226,519,"x11y26"],[247,519,"x12y26"],[267,519,"x13y26"],[288,519,"x14y26"],[309,519,"x15y26"],[329,519,"x16y26"],[350,519,"x17y26"],[371,519,"x18y26"],[391,519,"x19y26"],[412,519,"x20y26"],[433,519,"x21y26"],[453,519,"x22y26"],[474,519,"x23y26"],[495,519,"x24y26"],[515,519,"x25y26"],[536,519,"x26y26"],
[20,539,"x1y27"],[40,539,"x2y27"],[61,539,"x3y27"],[82,539,"x4y27"],[102,539,"x5y27"],[123,539,"x6y27"],[144,539,"x7y27"],[164,539,"x8y27"],[185,539,"x9y27"],[206,539,"x10y27"],[226,539,"x11y27"],[247,539,"x12y27"],[267,539,"x13y27"],[288,539,"x14y27"],[309,539,"x15y27"],[329,539,"x16y27"],[350,539,"x17y27"],[371,539,"x18y27"],[391,539,"x19y27"],[412,539,"x20y27"],[433,539,"x21y27"],[453,539,"x22y27"],[474,539,"x23y27"],[495,539,"x24y27"],[515,539,"x25y27"],[536,539,"x26y27"],
[20,559,"x1y28"],[40,559,"x2y28"],[61,559,"x3y28"],[82,559,"x4y28"],[102,559,"x5y28"],[123,559,"x6y28"],[144,559,"x7y28"],[164,559,"x8y28"],[185,559,"x9y28"],[206,559,"x10y28"],[226,559,"x11y28"],[247,559,"x12y28"],[267,559,"x13y28"],[288,559,"x14y28"],[309,559,"x15y28"],[329,559,"x16y28"],[350,559,"x17y28"],[371,559,"x18y28"],[391,559,"x19y28"],[412,559,"x20y28"],[433,559,"x21y28"],[453,559,"x22y28"],[474,559,"x23y28"],[495,559,"x24y28"],[515,559,"x25y28"],[536,559,"x26y28"],
[20,579,"x1y29"],[40,579,"x2y29"],[61,579,"x3y29"],[82,579,"x4y29"],[102,579,"x5y29"],[123,579,"x6y29"],[144,579,"x7y29"],[164,579,"x8y29"],[185,579,"x9y29"],[206,579,"x10y29"],[226,579,"x11y29"],[247,579,"x12y29"],[267,579,"x13y29"],[288,579,"x14y29"],[309,579,"x15y29"],[329,579,"x16y29"],[350,579,"x17y29"],[371,579,"x18y29"],[391,579,"x19y29"],[412,579,"x20y29"],[433,579,"x21y29"],[453,579,"x22y29"],[474,579,"x23y29"],[495,579,"x24y29"],[515,579,"x25y29"],[536,579,"x26y29"]
];

var keydown = false;
function setKeydown(e) {
	var e = e || window.event;
    switch (e.keyCode){
    	case 37:
    		keydown = 'left';
    		pacman.setDirection();
        	break;
	    case 38:
	    	keydown = 'up';
	    	pacman.setDirection();
	        break;
	    case 39:
	    	keydown = 'right';
	    	pacman.setDirection();
	        break;
	    case 40:
	    	keydown = 'down';
	    	pacman.setDirection();
	        break;
	    default:
	    	break;
 	}
}
function unsetKeydown(e) {
	keydown = false;
}

function Character(name,element) {
	this.characterName = name;
	this.character = element;
	this.direction = 'right';
	this.offset = 40;
	this.xPos = 259;
	this.yPos = 442;
	this.fps = 30;
	this.speedStep = 5;
	this.moveMouthSpeed = this.fps / 5;
	this.timeout = 1000 / this.fps;
	this.moveMouthCounter = 0;
	this.mouthOpen = true;

	requestAnimationFrame(this.move.bind(this));
}
Character.prototype.setDirection = function(newDirection) {
	if(newDirection !== undefined) {
		keydown = newDirection;
	}
    var currentDirection = this.direction;
    if(this.checkBoundary(keydown)) {
		this.character.className = this.character.className.replace(currentDirection,keydown);
    	this.direction = keydown;
    }
}
Character.prototype.moveMouth = function() {
	if(this.moveMouthCounter++ == this.moveMouthSpeed) {
		if(this.mouthOpen) {
			this.mouthOpen = false;
			this.character.className += ' closed';
		}
		else {
			this.mouthOpen = true;
			this.character.className = this.character.className.replace(' closed','');
		}
		this.moveMouthCounter = 0;
	}
}
Character.prototype.openMouth = function() {
	if(!this.mouthOpen) {
		this.mouthOpen = true;
		this.character.className = this.character.className.replace(' closed','');
	}
}
Character.prototype.checkBoundary = function(side) {
	var nextStep;
	var valid = true;
	switch(side) {
		case 'left':
			var xWall, xTop, xBottom;
			nextStep = this.xPos - this.speedStep;
			for(var i = 0;i < playmap.vertWallCoords.length;i++) {
				xWall = playmap.vertWallCoords[i][0];
				xTop = playmap.vertWallCoords[i][1];
				xBottom = playmap.vertWallCoords[i][2];
				if((nextStep < xWall) && (nextStep >= xWall - this.speedStep)) {
					if((this.yPos >= xTop && this.yPos < xBottom) || 
						(this.yPos + this.offset > xTop && this.yPos + this.offset < xBottom) || 
						(this.yPos < xTop && this.yPos + this.offset > xTop) || 
						(this.yPos < xBottom && this.yPos + this.offset > xBottom)) {
							valid = false;
							break;
					}
				}
			}
			if(this.yPos == playmap.warpTop && nextStep <= playmap.leftBound - this.offset) {
				this.xPos = playmap.rightBound;
			}
			break;
		case 'up':
			var yWall, yLeft, yRight;
			nextStep = this.yPos - this.speedStep;
			for(var i = 0;i < playmap.horzWallCoords.length;i++) {
				yWall = playmap.horzWallCoords[i][0];
				yLeft = playmap.horzWallCoords[i][1];
				yRight = playmap.horzWallCoords[i][2];
				if((nextStep < yWall) && (nextStep >= yWall - this.speedStep)) {
					if((this.xPos > yLeft && this.xPos < yRight) || 
						(this.xPos + this.offset > yLeft && this.xPos + this.offset < yRight) || 
						(this.xPos < yLeft && this.xPos + this.offset > yLeft) || 
						(this.xPos < yRight && this.xPos + this.offset > yRight)) {
							valid = false;
							break;
					}
				}
			}
			break;
		case 'right':
			var xWall, xTop, xBottom;
			nextStep = this.xPos + this.speedStep;
			for(var i = 0;i < playmap.vertWallCoords.length;i++) {
				xWall = playmap.vertWallCoords[i][0];
				xTop = playmap.vertWallCoords[i][1];
				xBottom = playmap.vertWallCoords[i][2];
				if((nextStep > xWall - this.offset) && (nextStep < xWall)) {
					if((this.yPos >= xTop && this.yPos < xBottom) || 
						(this.yPos + this.offset > xTop && this.yPos + this.offset < xBottom) || 
						(this.yPos < xTop && this.yPos + this.offset > xTop) || 
						(this.yPos < xBottom && this.yPos + this.offset > xBottom)) {
							valid = false;
							break;
					}
				}
			}
			if(this.yPos == playmap.warpTop && nextStep >= playmap.rightBound) {
				this.xPos = playmap.leftBound - this.offset;
			}
			break;
		case 'down':
			var yWall, yLeft, yRight;
			nextStep = this.yPos + this.speedStep;
			for(var i = 0;i < playmap.horzWallCoords.length;i++) {
				yWall = playmap.horzWallCoords[i][0];
				yLeft = playmap.horzWallCoords[i][1];
				yRight = playmap.horzWallCoords[i][2];
				if((nextStep > yWall - this.offset) && (nextStep < yWall)) {
					if((this.xPos > yLeft && this.xPos < yRight) || 
						(this.xPos + this.offset > yLeft && this.xPos + this.offset < yRight) || 
						(this.xPos < yLeft && this.xPos + this.offset > yLeft) || 
						(this.xPos < yRight && this.xPos + this.offset > yRight)) {
							valid = false;
							break;
					}
				}
			}
			break;
	}
	return valid;
}
Character.prototype.move = function() {
	if(keydown) {
		this.setDirection();
	}
	var self = this;
	setTimeout(function() {
		switch(self.direction) {
			case 'left':
				if(self.checkBoundary(self.direction)) {
					self.moveMouth();
					self.xPos -= self.speedStep;
					self.character.style.left = self.xPos;
				}
				else {
					self.openMouth();
				}
				break;
			case 'up':
				if(self.checkBoundary(self.direction)) {
					self.moveMouth();
					self.yPos -= self.speedStep;
					self.character.style.top = self.yPos;
				}
				else {
					self.openMouth();
				}
				break;
			case 'right':
				if(self.checkBoundary(self.direction)) {
					self.moveMouth();
					self.xPos += self.speedStep;
					self.character.style.left = self.xPos;
				}
				else {
					self.openMouth();
				}
				break;
			case 'down':
				if(self.checkBoundary(self.direction)) {
					self.moveMouth();
					self.yPos += self.speedStep;
					self.character.style.top = self.yPos;
				}
				else {
					self.openMouth();
				}
				break;
		}
		window.requestAnimationFrame(self.move.bind(self));
	}, self.timeout);
}

var pacmanEl = document.getElementById("pacman");
var pacman = new Character('Pac-Man', pacmanEl);

window.addEventListener('keydown', setKeydown);
window.addEventListener('keyup', unsetKeydown);